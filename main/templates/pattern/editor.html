{% extends 'base.html' %}
{% load static %}

{% block 'title' %}
    Паттерн {{ pattern.name }}
{% endblock %}

{% block 'body' %}
    <div style="width: inherit; height: inherit; overflow: scroll;">
        <canvas id="testCanvas" oncontextmenu="return false"
        style="display: none;">
            Ваш браузер не поддерживает canvas :/
        </canvas>
    </div>
{% endblock %}

{% block 'scripts' %}
    <script src="{% static 'libs/Tone.js' %}"></script>
    <script async src="{% static 'libs/paper.js' %}"></script>
    <script>
        const container = document.getElementById('_mainContainer');
        container.classList.remove('container');

        window.onresize = function () {
            const p = document.querySelector('script[type="text/paperscript"]');
            const cId = p.getAttribute('canvas');
            const canvas = document.querySelector(`canvas#${cId}`);
            canvas.style.display = 'block';
            canvas.focus();
            const sidebarWidth = document.getElementsByTagName('side-bar')
                .item(0).clientWidth;
            container.style = `
                width: ${document.body.clientWidth - sidebarWidth}px;
                height: 100vh;
            `;
        }

        // global
        var noteNotations = new Array(6).fill([
            'C', 'C#',
            'D', 'D#',
            'E',
            'F', 'F#',
            'G', 'G#',
            'A', 'A#',
            'B',
        ]).map((arr, i) => arr.map(note => note + (i + 2))).flat();
    </script>
    <script async type="text/paperscript" canvas="testCanvas"
    src="{% static 'scripts/noteEditor.js' %}"></script>
{% endblock %}
